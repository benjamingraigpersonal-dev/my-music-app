<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #0f0f0f; color: #ffffff; font-family: sans-serif; margin: 0; padding: 20px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .folder-title { font-size: 12px; text-transform: uppercase; color: #666; margin: 20px 0 10px; }
        .card { background: #1a1a1a; border-radius: 16px; padding: 12px; text-align: center; }
        .cover { width: 100%; aspect-ratio: 1; background: linear-gradient(135deg, #1db954, #191414); border-radius: 12px; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; font-size: 40px; }
        .title { font-size: 14px; font-weight: bold; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    </style>
</head>
<body>
    <h2>üéµ –ú–æ—è –ú–µ–¥–∏–∞—Ç–µ–∫–∞</h2>
    <div id="main-container"></div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        // –ß–∏—Ç–∞–µ–º –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –±–æ—Ç –ø–µ—Ä–µ–¥–∞–ª –≤ —Å—Å—ã–ª–∫–µ
        const urlParams = new URLSearchParams(window.location.search);
        const rawData = urlParams.get('data');
        const container = document.getElementById('main-container');

        if (rawData) {
            const musicData = JSON.parse(decodeURIComponent(rawData));
            
            for (const folderName in musicData) {
                const folderLabel = document.createElement('div');
                folderLabel.className = 'folder-title';
                folderLabel.innerText = folderName;
                container.appendChild(folderLabel);

                const grid = document.createElement('div');
                grid.className = 'grid';

                musicData[folderName].forEach(track => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.innerHTML = `<div class="cover">üéß</div><div class="title">${track.name}</div>`;
                    card.onclick = () => {
                        tg.sendData(JSON.stringify({action: "play", file_id: track.file_id, title: track.name}));
                        tg.close();
                    };
                    grid.appendChild(card);
                });
                container.appendChild(grid);
            }
        } else {
            container.innerHTML = "<p>–î–æ–±–∞–≤—å—Ç–µ –º—É–∑—ã–∫—É –≤ –±–æ—Ç–µ, —á—Ç–æ–±—ã –æ–Ω–∞ –ø–æ—è–≤–∏–ª–∞—Å—å –∑–¥–µ—Å—å.</p>";
        }
    </script>
</body>
</html>

